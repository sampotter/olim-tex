\documentclass[eikonal.tex]{subfiles}

\begin{document}

\section{$F_0$ Triangle Updates}

\begin{lemma}
  The solution of:
  \begin{align*}
    \lambda^* = \arg \min_{0 \leq \lambda \leq 1} F_0(\lambda; \theta)
  \end{align*}
  is given by
  
  where $\alpha = -\delta u/(s_\theta h)$.
\end{lemma}

\begin{proof}
  First:
  \begin{align*}
    F_0'(\lambda; \theta) = \delta u + \frac{s_\theta h q'(\lambda)}{2 l_\lambda} = \delta u + s_\theta h \frac{\delta p^\top p_\lambda}{l_\lambda}.
  \end{align*}
  Setting this equal to zero, rearranging terms, and squaring both
  sides gives
  $\alpha^2 p_\lambda^\top p_\lambda = {(\delta p^\top p_\lambda)}^2 =
  p_\lambda^\top \delta p \delta p^\top p_\lambda$. This is equivalent to:
  \begin{align*}
    \begin{bmatrix} \lambda \\ 1 \end{bmatrix}^\top \parens{
    \alpha^2 \begin{bmatrix}
      \norm{\delta p}^2 & \langle \delta p, p_0 \rangle \\
      \langle \delta p, p_0 \rangle & \norm{p_0}^2
    \end{bmatrix} - \begin{bmatrix}
      \norm{\delta p}^4 & \norm{\delta p}^2 \langle \delta p, p_0 \rangle \\
      \norm{\delta p}^2 \langle \delta p, p_0 \rangle & \langle \delta p, p_0 \rangle^2
    \end{bmatrix}
    } \begin{bmatrix} \lambda \\ 1 \end{bmatrix}^\top = 0,
  \end{align*}
  which is equivalent to
  $p(\lambda) = a \lambda^2 + 2b \lambda + c = 0$, where
  \begin{align*}
    a = \norm{\delta p}^2 \parens{\alpha^2 - \norm{\delta p}^2}, \qquad b = \langle \delta p, p_0 \rangle \parens{\alpha^2 - \norm{\delta p}^2}, \qquad c = \alpha^2 \norm{p_0}^2 - \langle \delta p, p_0 \rangle^2.
  \end{align*}
  The solution to $p(\lambda) = 0$ is $\lambda = -(b \pm \sqrt{b^2 - ac})/a$, i.e.:
  \begin{align*}
    \lambda = \frac{-1}{\norm{\delta p}^2} \parens{\langle p_0, \delta p \rangle \pm \alpha \sqrt{\frac{\langle p_0, \delta p \rangle^2 - \norm{p_0}^2 \norm{\delta p}^2}{\alpha^2 - \norm{\delta p}^2}}}.
  \end{align*}
  For these values of $\lambda$, if the square root is nonzero, then
  one of the two choices of sign will give a value of $\lambda$ which
  will also satisfy
  $\alpha l_\lambda = \langle \delta p, p_\lambda \rangle$.
\end{proof}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
